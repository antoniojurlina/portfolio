<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Predictive power - Kriging and Machine Learning | portfolio</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Predictive power - Kriging and Machine Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comparing the predictive power of kriging and Random Forests in R." />
<meta property="og:description" content="Comparing the predictive power of kriging and Random Forests in R." />
<link rel="canonical" href="https://antoniojurlina.github.io/portfolio/2020/12/04/kriging-and-machine-learning.html" />
<meta property="og:url" content="https://antoniojurlina.github.io/portfolio/2020/12/04/kriging-and-machine-learning.html" />
<meta property="og:site_name" content="portfolio" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-04T10:37:17-06:00" />
<script type="application/ld+json">
{"url":"https://antoniojurlina.github.io/portfolio/2020/12/04/kriging-and-machine-learning.html","@type":"BlogPosting","headline":"Predictive power - Kriging and Machine Learning","dateModified":"2020-12-04T10:37:17-06:00","datePublished":"2020-12-04T10:37:17-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://antoniojurlina.github.io/portfolio/2020/12/04/kriging-and-machine-learning.html"},"description":"Comparing the predictive power of kriging and Random Forests in R.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/portfolio/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://antoniojurlina.github.io/portfolio/feed.xml" title="portfolio" /><link rel="shortcut icon" type="image/x-icon" href="/portfolio/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    document.getElementsByClassName("page-link")[0].href="https://antoniojurlina.github.io"
    });
</script>


<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/portfolio/assets/js/mansory.js" type="text/javascript"></script>



<!-- Medium Zoom JS -->
    <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/portfolio/assets/js/zoom.js"></script>

</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/portfolio/">portfolio</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/portfolio/return/">Home</a><a class="page-link" href="/portfolio/search/">Search</a><a class="page-link" href="/portfolio/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Predictive power - Kriging and Machine Learning</h1><p class="page-description">Comparing the predictive power of kriging and Random Forests in R.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-04T10:37:17-06:00" itemprop="datePublished">
        Dec 4, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><br /></p>

<h5 id="1-objective">1. Objective</h5>

<p>The purpose of this project is to assess the predictive power of kriging (along with a generalized additive model) relative to that of a simple machine learning method like Random Forests, with ordinary least squares serving as the simplest (and most biased) approach. Furthermore, this project is specifically interested in the effect geographic location has on expected earnings for cab drivers in Manhattan. <strong>If drivers pick passengers up in downtown Manhattan, they will earn a higher wage on average, everything else equal, implying that geographic latitude is the most relevant factor when determining where to start</strong>. This is not a project that seeks to determine which specific variable contributes the most (on average with everything else held equal) to the final fares earned by cab drivers. Rather, it seeks to discover relevant relationship between latitude, longitude and fares collected. All other (known) effects are going to be accounted for and stripped away.</p>

<p><br /></p>

<p><em>Figure 1 - Spatial distribution of data</em></p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/spatial_distribution.png" data-zoomable="" />
    </div>
</div>

<p><em>Table 1. First 6 (out of 50,000) rows of the data</em></p>

<table>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>log(total earnings)</th>
<th>longitude</th>
<th>latitude</th>
<th>passenger count</th>
<th>trip distance</th>
<th>wday</th>
<th>hour</th>
<th>month</th>
<th>geometry</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3.23</td>
<td>-74</td>
<td>40.7</td>
<td>1</td>
<td>5.8</td>
<td>Wed</td>
<td>0</td>
<td>May</td>
<td>(-73.98457 40.71474)</td>
</tr>
<tr>
<td>2</td>
<td>1.7</td>
<td>-74</td>
<td>40.7</td>
<td>1</td>
<td>0.75</td>
<td>Thu</td>
<td>12</td>
<td>Aug</td>
<td>(-73.99466 40.74018)</td>
</tr>
<tr>
<td>3</td>
<td>2.2</td>
<td>-74</td>
<td>40.8</td>
<td>1</td>
<td>0.6</td>
<td>Thu</td>
<td>9</td>
<td>Feb</td>
<td>(-73.96581 40.75857)</td>
</tr>
<tr>
<td>4</td>
<td>2.01</td>
<td>-74</td>
<td>40.8</td>
<td>2</td>
<td>0.9</td>
<td>Sat</td>
<td>20</td>
<td>Feb</td>
<td>(-73.9655 40.79076)</td>
</tr>
<tr>
<td>5</td>
<td>2.56</td>
<td>-74</td>
<td>40.7</td>
<td>6</td>
<td>2.8</td>
<td>Sun</td>
<td>2</td>
<td>Oct</td>
<td>(-73.9968 40.74702)</td>
</tr>
<tr>
<td>6</td>
<td>2.31</td>
<td>-74</td>
<td>40.8</td>
<td>1</td>
<td>1.83</td>
<td>Mon</td>
<td>1</td>
<td>Feb</td>
<td>(-73.9706 40.76213)</td>
</tr>
</tbody>
</table>

<p><br /></p>

<h5 id="2-data">2. Data</h5>

<p>The data set used for this project comes from the “FOILing NYC’s Taxi Trip Data” project<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>. Chris Whong published 20 gigabytes of NYC Taxi data which includes fares, tips, pickup and drop-off latitudes and longitudes, medallion IDs, passenger numbers, trip durations, and more (Table 1). The sheer size of the data set (more than a 160 million observations over 2013 and 2014) meant that it would be computationally too expensive trying to process it locally. Therefore, a subset of 50,000 observations was randomly sampled, with each month of each year providing a roughly equal share of data points. This hopefully preserved any temporal effects that the data might have. Relevant visualization statistics are included in Figures 1 and 2. There was no missing data and trips with zero total fares earned were excluded (as they represent extremely unlikely and illegal scenarios usually).</p>

<p><br /></p>

<p><em>Table 2. Summary statistics of non-categorical variables</em></p>

<table>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>log(total earnings)</th>
<th>passenger count</th>
<th>trip distance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Min</td>
<td>1.099</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1st Quartile</td>
<td>2.079</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Median</td>
<td>2.398</td>
<td>1</td>
<td>1.735</td>
</tr>
<tr>
<td>Mean</td>
<td>2.447</td>
<td>1.717</td>
<td>2.545</td>
</tr>
<tr>
<td>3rd Quartile</td>
<td>2.755</td>
<td>2</td>
<td>2.978</td>
</tr>
<tr>
<td>Max</td>
<td>5.08</td>
<td>6</td>
<td>53</td>
</tr>
</tbody>
</table>

<p><em>Figure 2 - Temporal breakdown of the dependent variable</em></p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/temporal_breakdown.png" data-zoomable="" />
    </div>
</div>

<p><br /></p>

<h5 id="3-methods">3. Methods</h5>

<p>A simple OLS approach, in which the variable of interest is the log of total earnings (sum of the fare, tip, surcharge and tax), is the baseline approach of this project. Independent variables are pickup latitude, pickup longitude, trip distance, and number of passengers. Next, a GAM is estimated over the same basic formula, but with smoothing applied to latitude, longitude and trip distance (with an assumption that the exact shape of the effect these variables have on final earnings is unknown). The use of the GAM (to be followed with kriging of residuals) comes from a very similar idea Gámez et al.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> had in their work on estimating housing prices in Albacete by incorporating the neighborhood effects through spatial autocorrelation estimation and subsequent kriging of GAM residuals. In Manhattan, the assumption is that downtown pickups result in higher earnings. This indicates a certain weight neighboring points will have on each other as an isotropic spatial autocorrelation process. Therefore, the residuals of the GAM are expected to be biased, and kriging will be performed to account for and fix this. Kriging itself has a random component to it, as the underlying Gaussian process is used to interpolate predictions<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup> <sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup> <sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">5</a></sup>, which is what inspired the final aspect of this project, Random Forests.</p>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="#cc0000"><mtext>\alphaX</mtext></mstyle></mrow><annotation encoding="application/x-tex">log(Y)=\alphaX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\alphaX</span></span></span></span></span></span>

<p><em>Note: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span> is a single-column matrix of parameter values to be estimated, X is a n:1+m matrix of independent variables where n is the number of observations in data and m is the number of variables</em></p>

<p>Much like kriging, Random Forest models (as the name implies) rely on an underlying random process and are used in estimating spatial models and making predictions<sup id="fnref:6" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">6</a></sup> <sup id="fnref:7" role="doc-noteref"><a href="#fn:7" class="footnote" rel="footnote">7</a></sup>. In this project, a Random Forest model is used to estimate Equation 1, by growing 500 random decision trees across the data space and averaging them out into a prediction set. For the purposes of training the three models and subsequently testing them, the data is split into two subsets: first one contains a random subset of 75% of the data for training the models, while the second contains the remaining 25% for testing the predictions and estimating root mean square errors (Figure 3). These two datasets are used for the OLS, the GAM and kriging combination (with a spherical effect variogram model of the spatial dependence), and the Random Forest.</p>

<p><br /></p>

<p><em>Figure 3 - Temporal breakdown of the dependent variable</em></p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/test_train.png" data-zoomable="" />
    </div>
</div>

<p><br /></p>

<h5 id="4-results-and-discussion">4. Results and Discussion</h5>

<p>Residuals of the OLS and GAM processes were tested for residual normality, with both rejecting the null hypotheses (Table 3). After kriging of the residuals from the GAM was performed, to account for spatial dependence, initial estimates were adjusted with kriging results and after performing the same tests, residuals testing failed to reject the normality hypothesis (Table 3). Final estimates are shown in Table 4. Additionally, the variogram model for the residuals of the GAM is shown in Figure 4. Reduction of the data set down to a smaller subsample, as well as the narrow nature of Manhattan preventing higher horizontal variation in the data, is a possible explanation for the pronounced nugget effect with the cyclical trailing-off pattern in the variogram.</p>

<p><br /></p>

<p><em>Table 3. Tests for residual normality</em></p>

<table>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>model</th>
<th>statistic</th>
<th>p.value</th>
<th>test</th>
</tr>
</thead>
<tbody>
<tr>
<td>OLS</td>
<td>80898</td>
<td>0.000</td>
<td>Jarque Berra</td>
</tr>
<tr>
<td>GAM</td>
<td>7195.7</td>
<td>0.013</td>
<td>Jarque Berra</td>
</tr>
<tr>
<td>GAM+Krige</td>
<td>1889.1</td>
<td>0.135</td>
<td>Jarque Berra</td>
</tr>
<tr>
<td>OLS</td>
<td>0.88984</td>
<td>0.000</td>
<td>Shapiro-Wilk</td>
</tr>
<tr>
<td>GAM</td>
<td>0.91051</td>
<td>0.014</td>
<td>Shapiro-Wilk</td>
</tr>
<tr>
<td>GAM+Krige</td>
<td>1.0134</td>
<td>0.091</td>
<td>Shapiro-Wilk</td>
</tr>
</tbody>
</table>

<p><em>Figure 4 - Spherical variogram fit on GAM residuals</em></p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/variogram.png" data-zoomable="" />
    </div>
</div>

<p><br /></p>

<p>Looking at Table 4, having completed all the necessary tests, it can be noted that between two coordinate points, latitude is the relevant one in predicting total wage earned from taxi rides. By no means are these the most important factors, but the original hypothesis remains unrejected with these results. There is a strong case to be made that being uptown versus downtown is what matters more than being on the west or east side of the island. The exact effect of the relationship is quite small in the end, and not worth elaborating on more, as the goal of this project has been accomplished.</p>

<p><br /></p>

<p><em>Table 4. Model estimates</em></p>

<table>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>OLS</th>
<th>OLS</th>
<th>OLS</th>
<th>OLS</th>
<th>GAM</th>
<th>GAM</th>
<th>GAM</th>
<th>GAM</th>
</tr>
</thead>
<tbody>
<tr>
<td>term</td>
<td>estimate</td>
<td>std.error</td>
<td>statistic</td>
<td>p.value</td>
<td>estimate</td>
<td>std.error</td>
<td>statistic</td>
<td>p.value</td>
</tr>
<tr>
<td>intercept</td>
<td>-17</td>
<td>66.4</td>
<td>-0.255</td>
<td>0.798</td>
<td>2.340</td>
<td>0.014</td>
<td>169.866</td>
<td>0.000</td>
</tr>
<tr>
<td>pickup longitude</td>
<td>1.01</td>
<td>0.678</td>
<td>-0.921</td>
<td>0.357</td>
<td>1.38</td>
<td>1.673</td>
<td>2.744</td>
<td>0.134</td>
</tr>
<tr>
<td>pickup latitude</td>
<td>-0.669</td>
<td>0.519</td>
<td>-1.29</td>
<td>0.185</td>
<td>-0.564</td>
<td>0.321</td>
<td>0.086</td>
<td>0.002</td>
</tr>
<tr>
<td>passenger count</td>
<td>0.010</td>
<td>0.006</td>
<td>1.68</td>
<td>0.093</td>
<td>-0.001</td>
<td>0.004</td>
<td>-0.193</td>
<td>0.847</td>
</tr>
<tr>
<td>trip distance</td>
<td>0.148</td>
<td>0.003</td>
<td>51.5</td>
<td>0.000</td>
<td>7.664</td>
<td>8.511</td>
<td>933.442</td>
<td>0.000</td>
</tr>
</tbody>
</table>

<p><em>Table 5. Predictive and explanatory power</em></p>

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>RMSE</th>
<th>% Variance Explained</th>
</tr>
</thead>
<tbody>
<tr>
<td>OLS</td>
<td>0.318</td>
<td>71.60</td>
</tr>
<tr>
<td>GAM+Krige</td>
<td>0.225</td>
<td>85.1</td>
</tr>
<tr>
<td>RandomForest</td>
<td>0.252</td>
<td>81.31</td>
</tr>
</tbody>
</table>

<p><br /></p>

<p>When it comes to predictions, using the testing subset of the model data, we can see that moving from the OLS, over the GAM, to the Random Forest, there is a decreasing error in being able to predict where highest total wages will be earned (Figure 4; Table 5). It is important to note that the GAM/Krige combination explains most of the variance in the data and has best prediction rates, albeit very close to the Random Forest (see Figure 5 and Appendix for visualizations). The expectation for the project was that the Random Forest model would contain significantly better prediction rates. Kriging is a powerful (and computation heavy) tool for interpolating a random space realization into a usable set of predictions while maintaining the ability to give plausible reasoning behind starting assumptions. While it did outperform the simple machine learning technique, it should be noted that it is computationally much heavier. Were I to use the entire data set with over a 100 million observations, Random Forest prediction rate is still high enough that I would chose it over the computationally demanding kriging process.</p>

<p><br /></p>

<p><em>Figure 5 - Maps</em> <br />
<em>From left to right: Actual data, GAM+Krige predictions, RandomForest predictions</em></p>

<div class="row-grid">
    <div class="column-grid">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/map_actual.png" data-zoomable="" />
    </div>
    <div class="column-grid">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/map_krige.png" data-zoomable="" />
    </div>
    <div class="column-grid">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/map_randomForest.png" data-zoomable="" />
    </div>
</div>

<h5 id="5-github-repository">5. GitHub repository</h5>

<p>For data, code, and similar projects, visit <a href="https://github.com/antoniojurlina/spatial_analysis/tree/main/final%20project">https://github.com/antoniojurlina/spatial_analysis</a>.</p>

<h5 id="appendix-1-distributions">Appendix 1: Distributions</h5>

<p><br /></p>

<p><em>GAM+Krige prediction distribution (red) vs. actual data (blue)</em></p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/portfolio/images/predictions_distribution.png" data-zoomable="" />
    </div>
</div>

<p><br /></p>

<h5 id="appendix-2-r-code">Appendix 2: R Code</h5>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
</pre></td><td class="code"><pre><span class="w"> 

</span><span class="c1">#-------- packages --------</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">spdep</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggmap</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">viridis</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gstat</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">lmtest</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tseries</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">broom</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mgcv</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">randomForest</span><span class="p">)</span><span class="w">

</span><span class="c1">#-------- data and directory --------</span><span class="w">
</span><span class="n">paste0</span><span class="p">(</span><span class="n">here</span><span class="o">::</span><span class="n">here</span><span class="p">(),</span><span class="w"> </span><span class="s2">"/final project/data"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">setwd</span><span class="p">()</span><span class="w">

</span><span class="n">fares</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"fares.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">trips</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"trips.csv"</span><span class="p">)</span><span class="w">

</span><span class="n">taxi_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">left_join</span><span class="p">(</span><span class="n">fares</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"medallion"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hack_license"</span><span class="p">,</span><span class="w"> </span><span class="s2">"vendor_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pickup_datetime"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">hack_license</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">vendor_id</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">rate_code</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">store_and_fwd_flag</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">total_amount</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">pickup_latitude</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">40.70</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">40.83</span><span class="p">,</span><span class="w">
				 </span><span class="n">pickup_longitude</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">-74.025</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_longitude</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">-73.93</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">hour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hour</span><span class="p">(</span><span class="n">pickup_datetime</span><span class="p">),</span><span class="w">
				 </span><span class="n">wday</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wday</span><span class="p">(</span><span class="n">pickup_datetime</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
				 </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month</span><span class="p">(</span><span class="n">pickup_datetime</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">select</span><span class="p">(</span><span class="n">total_amount</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">,</span><span class="w"> </span><span class="n">passenger_count</span><span class="p">,</span><span class="w"> </span><span class="n">trip_distance</span><span class="p">,</span><span class="w"> </span><span class="n">wday</span><span class="p">,</span><span class="w"> </span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w">

</span><span class="n">sample_rows</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">taxi_data</span><span class="p">),</span><span class="w"> </span><span class="m">0.75</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">taxi_data</span><span class="p">))</span><span class="w">

</span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">taxi_data</span><span class="p">[</span><span class="n">sample_rows</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">taxi_data</span><span class="p">[</span><span class="o">-</span><span class="n">sample_rows</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="n">train_sf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">SpatialPointsDataFrame</span><span class="p">(</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w">
																	 </span><span class="n">proj4string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CRS</span><span class="p">(</span><span class="s2">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span><span class="p">))</span><span class="w">
</span><span class="n">test_sf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">SpatialPointsDataFrame</span><span class="p">(</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">[,</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w">
																	</span><span class="n">proj4string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CRS</span><span class="p">(</span><span class="s2">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span><span class="p">))</span><span class="w">

</span><span class="n">train_sf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_as_sf</span><span class="p">(</span><span class="n">train_sf</span><span class="p">)</span><span class="w">
</span><span class="n">test_sf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">st_as_sf</span><span class="p">(</span><span class="n">test_sf</span><span class="p">)</span><span class="w">

</span><span class="n">manhattan</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readRDS</span><span class="p">(</span><span class="s2">"manhattan.rds"</span><span class="p">)</span><span class="w">
</span><span class="c1">#-------- visualization and summary--------</span><span class="w">
</span><span class="n">ggmap</span><span class="p">(</span><span class="n">manhattan</span><span class="p">,</span><span class="w"> </span><span class="n">darken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">scale_fill_viridis</span><span class="p">(</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'plasma'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_bin2d</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taxi_data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">,</span><span class="w">
			 </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"latitude"</span><span class="p">,</span><span class="w">
			 </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"count"</span><span class="p">)</span><span class="w">

</span><span class="n">taxi_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="n">total_amount</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wday</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w">

</span><span class="n">bind_rows</span><span class="p">(</span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
						</span><span class="n">mutate</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test"</span><span class="p">),</span><span class="w">
					</span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
						</span><span class="n">mutate</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"train"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">total_amount</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gold"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">stat_summary</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="s2">"point"</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_par</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme</span><span class="p">(</span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span><span class="w">

</span><span class="c1">#-------- OLS --------</span><span class="w">
</span><span class="n">formula</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.formula</span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">pickup_longitude</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">passenger_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">trip_distance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wday</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hour</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w">

</span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gaussian"</span><span class="p">,</span><span class="w"> </span><span class="n">train</span><span class="p">)</span><span class="w">

</span><span class="n">test</span><span class="o">$</span><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span><span class="w">

</span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">summarize</span><span class="p">(</span><span class="n">rmse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">resid</span><span class="o">^</span><span class="m">2</span><span class="p">)))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">rmse_ols</span><span class="w">

</span><span class="c1">#-------- GAM --------</span><span class="w">
</span><span class="n">gam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">pickup_latitude</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">passenger_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">trip_distance</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wday</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hour</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gaussian"</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">)</span><span class="w">

</span><span class="n">cbind</span><span class="p">(</span><span class="n">fitted</span><span class="p">(</span><span class="n">gam</span><span class="p">),</span><span class="w"> </span><span class="n">residuals</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">as_tibble</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span><span class="w"> </span><span class="n">V2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">()</span><span class="w">

</span><span class="c1"># data with residuals</span><span class="w">
</span><span class="n">train_sf</span><span class="o">$</span><span class="n">resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">residuals</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span><span class="w">

</span><span class="n">test_sf</span><span class="o">$</span><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">gam</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span><span class="w">

</span><span class="n">test_sf</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">summarize</span><span class="p">(</span><span class="n">rmse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">resid</span><span class="o">^</span><span class="m">2</span><span class="p">)))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">rmse_gam</span><span class="w">


</span><span class="c1">#-------- Krige --------</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span><span class="w">

</span><span class="c1"># variograms</span><span class="w">
</span><span class="n">taxi_variogram</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">variogram</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
														</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">train_sf</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">total_amount</span><span class="p">),</span><span class="w">
														</span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">taxi_variogram</span><span class="p">)</span><span class="w">

</span><span class="n">spherical_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit.variogram</span><span class="p">(</span><span class="n">taxi_variogram</span><span class="p">,</span><span class="w"> </span><span class="n">vgm</span><span class="p">(</span><span class="m">0.05</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sph"</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">0.04</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">taxi_variogram</span><span class="p">,</span><span class="w"> </span><span class="n">spherical_fit</span><span class="p">)</span><span class="w">

</span><span class="c1"># ordinary kriging</span><span class="w">
</span><span class="n">train_sp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as_Spatial</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">train_sf</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">total_amount</span><span class="p">))</span><span class="w">
</span><span class="c1">#prediction_grid &lt;- spsample(train_sp, nrow(train_sf), type = "regular")</span><span class="w">
</span><span class="n">test_sp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as_Spatial</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">test_sf</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">pred</span><span class="p">))</span><span class="w">

</span><span class="n">spherical_krige</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">krige</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resid</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
												 </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_sp</span><span class="p">,</span><span class="w">
												 </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spherical_fit</span><span class="p">,</span><span class="w">
												 </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_sp</span><span class="p">,</span><span class="w">
												 </span><span class="n">nmax</span><span class="o">=</span><span class="m">15</span><span class="p">)</span><span class="w">

</span><span class="c1">#-------- GAM+Krige --------</span><span class="w">
</span><span class="n">final_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bind_cols</span><span class="p">(</span><span class="n">test_sf</span><span class="p">,</span><span class="w"> </span><span class="n">spherical_krige</span><span class="o">$</span><span class="n">var1.pred</span><span class="p">,</span><span class="w"> </span><span class="n">spherical_krige</span><span class="o">$</span><span class="n">var1.var</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">rename</span><span class="p">(</span><span class="s2">"variance"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"...12"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">...11</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="w"> </span><span class="n">...11</span><span class="p">)</span><span class="w">

</span><span class="n">final_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_amount</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">summarize</span><span class="p">(</span><span class="n">rmse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">resid</span><span class="o">^</span><span class="m">2</span><span class="p">)))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">rmse_gam_krige</span><span class="w">

</span><span class="c1">#-------- randomForests --------</span><span class="w">
</span><span class="n">rf_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">randomForest</span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">ntree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">

</span><span class="n">test</span><span class="o">$</span><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">predict</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"class"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="p">))</span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">scale_color_gradient_tableau</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">coord_equal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_par</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"total earnings"</span><span class="p">,</span><span class="w">
			 </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log(total earnings)"</span><span class="p">,</span><span class="w">
			 </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Manhattan"</span><span class="p">,</span><span class="w">
			 </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">,</span><span class="w">
			 </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"latitude"</span><span class="p">)</span><span class="w">

</span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">residual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_amount</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">summarize</span><span class="p">(</span><span class="n">rmse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">residual</span><span class="o">^</span><span class="m">2</span><span class="p">)))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">rmse_rf</span><span class="w">

</span><span class="c1">#-------- plots + tests --------</span><span class="w">
</span><span class="n">jarque.bera.test</span><span class="p">(</span><span class="n">residuals</span><span class="p">(</span><span class="n">model</span><span class="p">))</span><span class="w">
</span><span class="n">jarque.bera.test</span><span class="p">(</span><span class="n">residuals</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span><span class="w">
</span><span class="n">final_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_amount</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">as_tibble</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">select</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">pull</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">jarque.bera.test</span><span class="p">()</span><span class="w">

</span><span class="n">shapiro.test</span><span class="p">(</span><span class="n">residuals</span><span class="p">(</span><span class="n">model</span><span class="p">))</span><span class="w">
</span><span class="n">shapiro.test</span><span class="p">(</span><span class="n">residuals</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span><span class="w">
</span><span class="n">final_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_amount</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">as_tibble</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">select</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">pull</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">shapiro.test</span><span class="p">()</span><span class="w">

</span><span class="n">final_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nf">exp</span><span class="p">(</span><span class="n">pred</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="p">),</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">coord_equal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">scale_color_gradient_tableau</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_par</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"total earnings"</span><span class="p">,</span><span class="w">
			 </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log(total earnings)"</span><span class="p">,</span><span class="w">
			 </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Manhattan"</span><span class="p">,</span><span class="w">
			 </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">,</span><span class="w">
			 </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"latitude"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">final_data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">total_amount</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_amount</span><span class="p">))</span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">scale_color_gradient_tableau</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">coord_equal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_par</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"total earnings"</span><span class="p">,</span><span class="w">
			 </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log(total earnings)"</span><span class="p">,</span><span class="w">
			 </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Manhattan"</span><span class="p">,</span><span class="w">
			 </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">,</span><span class="w">
			 </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"latitude"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">final_data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span><span class="w"> </span><span class="n">pickup_latitude</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">variance</span><span class="p">)))</span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">scale_color_gradient_tableau</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">coord_equal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_map</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"fare"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">final_data</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">total_amount</span><span class="p">)),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"royalblue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">pred</span><span class="p">)),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
			 </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"total earnings"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h5 id="works-cited">Works Cited</h5>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Whong, C. (2014, March 18). FOILing NYC’s Taxi Trip Data. https://chriswhong.com/open-data/foil_nyc_taxi/ <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>Gámez, M., Montero, J., &amp; Rubio, N. (2000). Kriging methodology for regional economic analysis: Estimating the housing price in Albacete. International Advances in Economic Research, 6, 438–450. https://doi.org/10.1007/BF02294963 <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>Krige, D. G. (1951). A statistical approach to some mine valuation and allied problems on the Witwatersrand [Thesis]. http://wiredspace.wits.ac.za/handle/10539/17975 <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:4" role="doc-endnote">
      <p>Matheron, G. (1973). The Intrinsic Random Functions and Their Applications. Advances in Applied Probability, 5(3), 439–468. https://doi.org/10.2307/1425829 <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:5" role="doc-endnote">
      <p>Matheron, Georges. (1963). Principles of geostatistics. Economic Geology, 58(8), 1246–1266. https://doi.org/10.2113/gsecongeo.58.8.1246 <a href="#fnref:5" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:6" role="doc-endnote">
      <p>Breiman, L. (2001). Random Forests. Machine Learning, 45(1), 5–32. https://doi.org/10.1023/A:1010933404324 <a href="#fnref:6" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:7" role="doc-endnote">
      <p>Tin Kam Ho. (1998). The random subspace method for constructing decision forests. IEEE Transactions on Pattern Analysis and Machine Intelligence, 20(8), 832–844. https://doi.org/10.1109/34.709601 <a href="#fnref:7" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div><a class="u-url" href="/portfolio/2020/12/04/kriging-and-machine-learning.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/portfolio/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/portfolio/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/portfolio/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/antoniojurlina" title="antoniojurlina"><svg class="svg-icon grey"><use xlink:href="/portfolio/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
